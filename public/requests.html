<!DOCTYPE HTML>
<head>
  <title>Requests</title>
  <meta charset = "UTF-8">
<script
  src="https://code.jquery.com/jquery-3.4.1.js"
  integrity="sha256-WpOohJOqMqqyKL9FccASB9O0KwACQJpFTUBLTYOVvVU="
  crossorigin="anonymous">
</script>
</head>
<body>

<script language="javascript">

    var u = "eecs";
    var f = "Keanu";
    var l = "Reeves";
    var p = "password";

    var user = { username: u,
                 firstname: f,
                 lastname: l,
                 password: p
    };


    // get all users
    function getAllUsers() {
        var request = new XMLHttpRequest();
        request.open("GET", "https://ez-recipe.herokuapp.com/api/users", true);

        request.onreadystatechange = function() {
            if (request.readyState == 4 && request.status == 200) {
                var result = request.responseText;    
                console.log(result);  
            }
            else if (request.readyState == 4 && request.status != 200) {
                console.log("error");
            }
        }

        request.send();
    }

    // get a particular user - only diff is we add username at end of url
    function getUser() {
        var request = new XMLHttpRequest();
        request.open("GET", "https://ez-recipe.herokuapp.com/api/users/llabell", true);

        request.onreadystatechange = function() {
            if (request.readyState == 4 && request.status == 200) {
                var result = request.responseText;    
                console.log(result);  
            }
            else if (request.readyState == 4 && request.status != 200) {
                console.log("error");
            }
        }

        request.send();
    }

    // add a new user - make sure to check username is unique before doing this
    function addUser() {
        var request = new XMLHttpRequest();
        request.open("POST", "https://ez-recipe.herokuapp.com/api/users", true);
        request.setRequestHeader("Content-Type", "application/json;charset=UTF-8");

        request.onreadystatechange = function() {
            if (request.readyState == 4 && request.status == 200) {
                var result = request.responseText;    
                console.log(result);  
            }
            else if (request.readyState == 4 && request.status != 200) {
                console.log("error");
            }
        }

        request.send(JSON.stringify(user));
    }

    getAllUsers();
    addUser();
    getUser();

</script>  


</body>
</html>


